############################################
CALL SR 1 - Enter # of Players
CALL SR 2 - Get Player Info
CALL SR 9 - Calculate Hands

SR 0 Print "Enter number of players"
ENDSR

SR 1 Get#OfPlaayers
	PUSH 100
	READ # into @100
ENDSR

SR 2 EnterPlayerInfo
	PUSH 0
	LABEL 3 EnterPlayerCards
		CALL SR 5
		PUSH 1
		ADD
		DUP
		PUSH 100
		RETRIEVE @100
		SUB
		JUMPIF0 8
		JUMP 3
	LABEL 8
	DISCARD
ENDSR

SR 4 Print "Player i, please enter the value of card #1:"
	PRINT "Player "
	DUP
	PUSH 10
	DIV
	PUSH 1
	ADD
	PRINT #
	PRINT ", please enter the value of card #"
	DUP
	PUSH 10
	MOD
	PUSH 1
	ADD
	PRINT #
	PRINT " (2-10,J,Q,K,A):"
ENDSR

SR 19 Print "suit"
	PRINT "Player "
	DUP
	PUSH 10
	DIV
	PUSH 1
	ADD
	PRINT #
	PRINT ", please enter a suit for card #"
	DUP
	PUSH 10
	MOD
	PUSH 1
	ADD
	PRINT #
	PRINT " (C,H,S,D):"
ENDSR

SR 5 EnterCards
	DUP
	PUSH 10
	MULTIPLY (10 * currentplayer)
	LABEL 6
		DUP (heapindex)
		
		//Read value
		CALL SR 4
		PUSH 101
		READC
		
		//Read suit
		CALL SR 5
		PUSH 102
		READC
		
		PUSH 101
		RETRIEVE
		CALL SR 20
		PUSH 102
		RETRIEVE
		CALL SR 26
		PUSH 13
		MULTIPLY
		ADD
		STORE
		
		PUSH 1
		ADD (heapindex + 1)
		DUP
		PUSH 5
		MOD
		JUMPIF0 7
		JUMP 6
	LABEL 7
	DISCARD
ENDSR

SR 20 Character to card value
	DUP
	PUSH 01000001 (A)
	SUB
	JUMPIF0 21
	
	DUP
	PUSH 01001011 (K)
	SUB
	JUMPIF0 22
	
	DUP
	PUSH 01010001 (Q)
	SUB
	JUMPIF0 23
	
	DUP
	PUSH 01001010 (Q)
	SUB
	JUMPIF0 24
	
	DUP
	PUSH 00110001 (10)
	SUB
	JUMPIF0 25
	
	PUSH 50
	SUB
	SWAP
	DROP
	ENDSR
	
	LABEL 21
		DROP
		PUSH 12
		ENDSR
	
	LABEL 22
		DROP
		PUSH 11
		ENDSR
		
	LABEL 23
		DROP
		PUSH 10
		ENDSR
	
	LABEL 24
		DROP
		PUSH 9
		ENDSR
		
	LABEL 25
		DROP
		PUSH 8
		ENDSR

SR 26 Character to suit
	DUP
	PUSH 01000011 (C)
	SUB
	JUMPIF0 27
	
	DUP
	PUSH 01001000 (H)
	SUB
	JUMPIF0 28
	
	DUP
	PUSH 01010011 (S)
	SUB
	JUMPIF0 29
	
	DROP
	PUSH 3 (D)
	ENDSR
	
	LABEL 27
		DROP
		PUSH 0
		ENDSR
	
	LABEL 28
		DROP
		PUSH 1
		ENDSR
		
	LABEL 29
		DROP
		PUSH 2
		ENDSR
ENDSR

SR 9 Calculate Hands
	PUSH 0
	LABEL 10
		CALL SR 12 (CheckFlush)
		PUSH 1
		ADD
		DUP
		PUSH 100
		RETRIEVE @100
		SUB
		JUMPIF0 11
		JUMP 10
	LABEL 11
	DISCARD
ENDSR

SR 12 Check Flush
	DUP (currentplayer)
	PUSH 10
	MULTIPLY (10 * currentplayer)
	DUP
	RETRIEVE
	CALL SR 13 (GetSuit)
	PUSH 101 (srheap 1)
	SWAP
	STORE (store suit in srheap1)
	LABEL 14
		DROP
		PUSH 1
		ADD (card0index + 1)
		
		//Are all cards checked?
		DUP
		PUSH 5
		MOD
		JUMPIF0 15

		//Check Card suite
		DUP
		RETRIEVE
		CALL SR 13 (GetSuit)
		PUSH 101 (srheap 1)
		RETRIEVE
		SUB
		
		JUMPIF0 14
		DROP
		DROP
		ENDSR
	LABEL 15
		DROP
		DUP (currentplayer)
		PUSH 200
		ADD
		PUSH 4 (flushvalue)
		STORE (flushvalue in currentplayerhandvalue)
ENDSR

SR 13 GetSuit
	DUP (cardindex)
	PUSH 13
	DIV
ENDSR

SR 16 Check3OfAKind
	DUP (currentplayer)
	PUSH 10
	MULTIPLY (10 * currentplayer)
	LABEL 17
		CALL SR 20 (getvalue)
		PUSH 101
		SWAP
		STORE (put current value in heap)
		PUSH 102
		PUSH 1
		STORE
		
		LABEL 18
			DUP (heapindexofcurrentcard)
			PUSH 1
			ADD (nextindex)
			
			//Are all cards checked?
			DUP
			PUSH 5
			MOD
			JUMPIF0 19
			
			DUP
			RETRIEVE
			CALL SR 20 (getvalue)
			PUSH 101
			RETRIEVE
			SUB
			JUMPIF0 20
			JUMP 18
			LABEL 20
				PUSH 102
				RETRIEVE
				PUSH 1
				ADD
				DUP
				PUSH 3
				SUB
				JUMPIF0 21
				PUSH 102
				SWAP
				STORE
				JUMP 18
			LABEL 21
				DROP
				DROP
				DUP (currentplayer)
				PUSH 200
				ADD
				PUSH 3 (3ofakindvalue)
				STORE (flushvalue in currentplayerhandvalue)
				ENDSR
		LABEL 19
			DROP
			PUSH 1
			ADD
			DUP
			PUSH 3
			MOD
			JUMPIF0 17
			DROP
			ENDSR
ENDSR
